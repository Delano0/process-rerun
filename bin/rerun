#!/usr/bin/env node

process.title = 'protractor-rerun'

const path = require('path')
const {walkSync, buildExeRun, getRunCommand} = require('../lib')

const argv = require('minimist')(process.argv.slice(2));

const maxSessionCount = argv.maxSessionCount || 5
const specRerunCount = argv.specRerunCount || 2
const configFilePath = argv.configPath || path.resolve(process.cwd(), './protractor.conf.js')
const specDir = argv.specsDir || path.resolve(process.cwd(), './specs')


buildExeRun({maxSessionCount, specRerunCount})(walkSync(specDir).map((file) => getRunCommand(file, configFilePath)))